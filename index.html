<!DOCTYPE html>
<html>
    <head>
    <script type="text/javascript" src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="b5nqlrfky8za0m9"></script>
    <!--<script src="https://unpkg.com/dropbox/dist/Dropbox-sdk.min.js"></script>  -->
        <title>DBExplorer</title>
        <style>
            #topdiv
            {
                margin-top:0;
                position:fixed;
                top:0;
            }
            
            #btn1
            {
               width:20;
            }
            #mainDiv
            {
                background:#3090C7;
                height:80vh;
                border-radius:10px;   
            }
            .mod
            {
                
                width:50%;
            }
            
            .buttonStyle {
            	border-radius:3px;
                background-color: #555555; /* Blue */
                border: none;
                color: white;
                padding: 15px 32px;
                text-align: center;
                text-decoration: none;
                display: inline-block;
                font-size: 16px;
                margin: 4px 2px;
                cursor: pointer;
                
            }
            .TextStyle {
            	border-radius:3px;
                background-color: #555555; /* Blue */
                border: none;
                color: white;
                padding: 15px 32px;
                text-align: center;
                text-decoration: none;
                display: inline-block;
                font-size: 16px;
                margin: 4px 2px;
                cursor: pointer;
                
            }
            .buttonStyle:hover
            {
                background-color: #e7e7e7;
                
            }
        </style>
    </head> 

    <body>
        <div>
            <center>
                <img class='mod' src='https://i.imgur.com/CHavGO3.jpg' />
            </center>
        </div>
        <div id='mainDiv'>
            <center>
                <h1 style="color:white;" id='sample'>Please Choose among the options</h1>
            </center>
            <center>
                <button onclick='chooser()' class='buttonStyle' style='margin-right:100px;'>Download Files</button>
                <font >Enter file path:</font>
                <input type='text' class='TextStyle' value='' id='filePath'/>
                <button class='buttonStyle'  onclick='uploadFile()'>Upload</button>
                <br>
                <button class='buttonStyle' id='fileDownload' onclick='download()'></button>
                <h2 id='progressUpload'></h2>
            </center>
        </div>

        <script type="text/javascript">
            
            
            function uploadFile()
            {
                var path = document.getElementById('filePath').value;
                if(path.length==0)
                {
                    alert('INVALID PATH');
                }
                else{
                    //alert(path);
                    Dropbox.save(document.getElementById('filePath').value,optionsUpload);
                    return false;   
                }
                
            }
            
            function download(){
                
                //window.location.href = 'http://www.google.com';
                window.location.href = link.getLink();
            }
            
            document.getElementById('fileDownload').style.visibility='hidden';
            
            var link = (function()   
            {
                var linkVal; // PRIVATE OBJECT
                var public={}; // PUBLIC OBJECT
                
                public.setLink=function(l)
                {
                    linkVal = l;
                };
                
                public.getLink = function()
                {
                    return linkVal;
                };
                return public;  //NEEDED IN ORDER FOR OTHER FUNCTION TO ACCESS PRIVATE OBJECT
            }());
            
            var optionsUpload = {
                // Success is called once all files have been successfully added to the user's
                // Dropbox, although they may not have synced to the user's devices yet.
                success: function () {
                    // Indicate to the user that the files have been saved.
                    alert("Success! Files saved to your Dropbox.");
                    document.getElementById('progressUpload').style.visibility='hidden';
                },
            
                // Progress is called periodically to update the application on the progress
                // of the user's downloads. The value passed to this callback is a float
                // between 0 and 1. The progress callback is guaranteed to be called at least
                // once with the value 1.
                progress: function (progress){
                    document.getElementById('progressUpload').innerHTML='Upload in progress';
                },
            
                // Cancel is called if the user presses the Cancel button or closes the Saver.
                cancel: function () {
                    document.getElementById('progressUpload').style.visibility='hidden';
                },
            
                // Error is called in the event of an unexpected response from the server
                // hosting the files, such as not being able to find a file. This callback is
                // also called if there is an error on Dropbox or if the user is over quota.
                error: function (errorMessage) {
                    
                    alert('Local file uploads are not supported for now [ONLY HTTP and HTTPS are supported]');
                    document.getElementById('progressUpload').style.visibility='hidden';
                    //alert('ERROR AYITHI DOSTA.. TRY AGAIN LATER /\\');
                }
            };
            
            options = {
            
                error: function (errorMessage) {},
                // Required. Called when a user selects an item in the Chooser.
               
                success:function(files) {
                    document.getElementById('fileDownload').style.visibility='visible';
                    document.getElementById('fileDownload').innerHTML='Click Here';
                    link.setLink(files[0].link.substr(0,files[0].link.length-1)+'1');
                },

                // Optional. Called when the user closes the dialog without selecting a file
                // and does not include any parameters.
                cancel: function() {

                },

                // Optional. "preview" (default) is a preview link to the document for sharing,
                // "direct" is an expiring link to download the contents of the file. For more
                // information about link types, see Link types below.
                linkType: "preview", // or "direct"

                // Optional. A value of false (default) limits selection to a single file, while
                // true enables multiple file selection.
                multiselect: false, // or true

                // Optional. This is a list of file extensions. If specified, the user will
                // only be able to select files with these extensions. You may also specify
                // file types, such as "video" or "images" in the list. For more information,
                // see File types below. By default, all extensions are allowed.
                //extensions: ['.pdf', '.doc', '.docx', '.png', '.jpeg', '.jpg'],
            };
            
            function chooser(){
                Dropbox.choose(options);
            }
        </script>
    </body>
</html>
